---           
layout: post
title: Polyglot Hadoop â€“ JSR 223 Scripting with Hadoop
date: 2013-02-27 15:23:45 UTC
updated: 2013-02-27 15:23:45 UTC
comments: false
categories: dsl hadoop polyglot
---

<div><br /></div>If you think that Hadoop Streaming is somehow limited, &nbsp;and you need to access the &nbsp;JVM functionalities while still using another language, you might be interested in checking out PHadoop (Polyglot Hadoop).<br /><br /><br />PHadoop is a MapReduce job that has some JSR 223 related wrappers inside. Right now it supports basic JavaScript and Python execution inside the JVM. But other JSR 223 supported languages can be added very easily. There is some work to release it for general usage but still there is some fun stuff in here.<br /><br />The source code is available on <a href="https://github.com/codemomentum/phadoop">github</a>.<br /><br />Here is a WordCount sample implemented with JavaScript and Python:<br /><div><br /></div><div>Mapper.js</div><div><br /></div><div><pre style="background-color: whitesmoke; color: #404040; font-size: 12px;"><code style="background-color: #ffffc1;">function map(key, value, context){<br />    words = value.toString().split(' ');<br />    for(var i=0; i &lt; words.length; i++) {<br />        var word = words[i];<br />        _key.set(word);<br />        _value.set('1');<br />        context.write(_key,_value);<br />    }<br />}</code></pre></div><div><br /></div><div>Reducer.py</div><div><br /></div><div><pre style="background-color: whitesmoke; color: #404040; font-size: 12px;"><pre><code style="background-color: #ffffc1; background-position: initial initial; background-repeat: initial initial;">def reduce(key,values,context):<br />    count = 0<br />    for value in values:<br />        count+=1<br />    _key.set(key)<br />    _value.set(str(count))<br />    context.write(_key,_value)</code></pre></pre></div>